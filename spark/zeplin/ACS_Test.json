{"paragraphs":[{"text":"%spark.pyspark\n\nprint('Spark Context Version: {}'.format(sc.version))","user":"anonymous","dateUpdated":"2020-09-08T13:58:23+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Spark Context Version: 2.4.5-amzn-0\n"}]},"apps":[],"jobName":"paragraph_1599139487568_94870311","id":"20200903-132447_359462921","dateCreated":"2020-09-03T13:24:47+0000","dateStarted":"2020-09-08T13:58:23+0000","dateFinished":"2020-09-08T13:58:23+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1560"},{"text":"%spark.pyspark\n\nimport boto3\n\n\ntry:\n    \n    session =  boto3.Session(region_name='us-east-1')\n    print('session', session)\n    \n    s3_resource = session.resource(service_name='s3')\n    print('s3_resource', s3_resource)\n    \n    s3_parameter = boto3.client('s3',region_name='us-east-1')\n    print('s3_parameter', s3_parameter)\n    \n    paginator = s3_parameter.get_paginator(\"list_objects\")\n    print('paginator')\n    \n    pages = paginator.paginate()\n    print('pages')\n        \n    \n    s3_bucket = s3_resource.Bucket('271849239056-dev-datagov-stage-s3/datasource=acs/demographics')\n    print('s3_bucket', s3_bucket.objects)\n    \n    if not list(s3_bucket.objects):\n        print('++')\n    else:\n        paginator = s3_parameter.get_paginator(\"list_objects\")\n        print('paginator')\n        pages = paginator.paginate(Bucket=bucket)\n        print('pages')\n        for page in pages:\n            for obj in page['Contents']:\n                if \"_SUC\" not in obj['Key']:\n                    print(obj['Key'])\n                else:\n                    print('--')\n                    pass\nexcept Exception as e:\n    print('Exception', e)\n    ","user":"anonymous","dateUpdated":"2020-09-08T13:58:23+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","editorHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"session Session(region_name='us-east-1')\ns3_resource s3.ServiceResource()\ns3_parameter <botocore.client.S3 object at 0x7f7b5a1750d0>\npaginator\npages\ns3_bucket s3.Bucket.objectsCollectionManager(s3.Bucket(name='271849239056-dev-datagov-stage-s3/datasource=acs/demographics'), s3.ObjectSummary)\nException 's3.Bucket.objectsCollectionManager' object is not iterable\n"}]},"apps":[],"jobName":"paragraph_1599139540743_1474090881","id":"20200903-132540_2064223291","dateCreated":"2020-09-03T13:25:40+0000","dateStarted":"2020-09-08T13:58:23+0000","dateFinished":"2020-09-08T13:58:23+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1561"},{"text":"%spark.pyspark\n\nimport logging\nimport boto3\nfrom botocore.exceptions import ClientError\n\ns3 = boto3.client('s3')\nresponse = s3.list_buckets()\n\n# Output the bucket names\nprint('Existing buckets:')\nfor bucket in response['Buckets']:\n    print(f'  {bucket[\"Name\"]}')\n    \n \n    \n    ","user":"anonymous","dateUpdated":"2020-09-08T13:58:23+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"1":{"graph":{"mode":"table","height":300,"optionOpen":false}}},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","editorHide":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1599140117541_1714666056","id":"20200903-133517_2129732308","dateCreated":"2020-09-03T13:35:17+0000","dateStarted":"2020-09-08T13:58:23+0000","dateFinished":"2020-09-08T13:58:23+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1562","errorMessage":""},{"text":"%spark.pyspark\n\nimport boto3\n\n# qcpyxistest/demographics\n\ns3 = boto3.client('s3')\n\nresponse = s3.list_objects_v2(\n          Bucket='qcpyxistest',\n            Prefix='demographics',\n            MaxKeys=10000 )\n            \n# all_objects = s3.list_objects(Bucket = '271849239056-dev-datagov-stage-s3/datasource=acs/demographics') \n\n# files=list(filter(lambda x:( x['Key'].find('_new_') !== -1),response['Contents']))\n# files=list(map(lambda x:(print(x)),response['Contents']))\n# print(files)\n\n# if response['KeyCount'] > 0:\n#     print(response['KeyCount'])\n#     for content in response['Contents']:\n#             print(f'  {content[\"Key\"]}')\n# else: \n#     print (response['KeyCount'])\nfiles=[]\nif response['KeyCount'] > 0:\n    for content in response['Contents']:\n        if content[\"Key\"].find('_new_') != -1:\n            files.append(content[\"Key\"])\nelse: \n    print (response['KeyCount'])\n\nprint(len(files))\nprint(files)\n\n \n    \n    ","user":"anonymous","dateUpdated":"2020-09-09T09:46:55+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"32\n['demographics/B25070/_new_B25070-2011/acs5-2011-860-B25070.json', 'demographics/B25070/_new_B25070-2012/acs5-2012-860-B25070.json', 'demographics/B25070/_new_B25070-2013/acs5-2013-860-B25070.json', 'demographics/B25070/_new_B25070-2014/acs5-2014-860-B25070.json', 'demographics/B25070/_new_B25070-2015/acs5-2015-860-B25070.json', 'demographics/B25070/_new_B25070-2016/acs5-2016-860-B25070.json', 'demographics/B25070/_new_B25070-2017/acs5-2017-860-B25070.json', 'demographics/B25070/_new_B25070-2018/acs5-2018-860-B25070.json', 'demographics/B25091/_new_B25091-2011/acs5-2011-860-B25091.json', 'demographics/B25091/_new_B25091-2012/acs5-2012-860-B25091.json', 'demographics/B25091/_new_B25091-2013/acs5-2013-860-B25091.json', 'demographics/B25091/_new_B25091-2014/acs5-2014-860-B25091.json', 'demographics/B25091/_new_B25091-2015/acs5-2015-860-B25091.json', 'demographics/B25091/_new_B25091-2016/acs5-2016-860-B25091.json', 'demographics/B25091/_new_B25091-2017/acs5-2017-860-B25091.json', 'demographics/B25091/_new_B25091-2018/acs5-2018-860-B25091.json', 'demographics/B25092/_new_B25092-2011/acs5-2011-860-B25092.json', 'demographics/B25092/_new_B25092-2012/acs5-2012-860-B25092.json', 'demographics/B25092/_new_B25092-2013/acs5-2013-860-B25092.json', 'demographics/B25092/_new_B25092-2014/acs5-2014-860-B25092.json', 'demographics/B25092/_new_B25092-2015/acs5-2015-860-B25092.json', 'demographics/B25092/_new_B25092-2016/acs5-2016-860-B25092.json', 'demographics/B25092/_new_B25092-2017/acs5-2017-860-B25092.json', 'demographics/B25092/_new_B25092-2018/acs5-2018-860-B25092.json', 'demographics/B25119/_new_B25119-2011/acs5-2011-860-B25119.json', 'demographics/B25119/_new_B25119-2012/acs5-2012-860-B25119.json', 'demographics/B25119/_new_B25119-2013/acs5-2013-860-B25119.json', 'demographics/B25119/_new_B25119-2014/acs5-2014-860-B25119.json', 'demographics/B25119/_new_B25119-2015/acs5-2015-860-B25119.json', 'demographics/B25119/_new_B25119-2016/acs5-2016-860-B25119.json', 'demographics/B25119/_new_B25119-2017/acs5-2017-860-B25119.json', 'demographics/B25119/_new_B25119-2018/acs5-2018-860-B25119.json']\n"}]},"apps":[],"jobName":"paragraph_1599208466379_1977654740","id":"20200904-083426_302290328","dateCreated":"2020-09-04T08:34:26+0000","dateStarted":"2020-09-09T09:46:55+0000","dateFinished":"2020-09-09T09:46:55+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1563"},{"text":"%spark.pyspark\n\nimport boto3\n\ns3 = boto3.client('s3')\n\ns3.Object('my_bucket','new_file_key').copy_from(CopySource='my_bucket/datasource=acs/demographics/_new_B25092-2011/acs5-2011-860-B25092.json')\n# s3.Object('my_bucket','old_file_key').delete()\n\nresponse1 = s3.copy_object(\n    Bucket='271849239056-dev-datagov-stage-s3',\n    CopySource=\"271849239056-dev-datagov-stage-s3/datasource=acs/demographics/_new_B25092-2011\",\n    Key='acs5-2011-860-B25092.json',\n)\n\nprint(response1)\n\n\nresponse = s3.list_objects_v2(\n            Bucket='271849239056-dev-datagov-stage-s3',\n            Prefix ='datasource=acs/demographics/_new_',\n            MaxKeys=10000 )\n            \nif response['KeyCount'] > 0:\n    print(response['KeyCount'])\n    for content in response['Contents']:\n            print(f'  {content[\"Key\"]}')\nelse: \n    print (response['KeyCount'])\n \n","user":"anonymous","dateUpdated":"2020-09-09T09:06:16+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","editorHide":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1599210309746_-637521022","id":"20200904-090509_330508342","dateCreated":"2020-09-04T09:05:09+0000","dateStarted":"2020-09-08T13:58:23+0000","dateFinished":"2020-09-08T13:58:23+0000","status":"ERROR","progressUpdateIntervalMs":500,"$$hashKey":"object:1564","errorMessage":""},{"text":"%spark.pyspark\n","user":"anonymous","dateUpdated":"2020-09-08T13:37:25+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","editorHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1599211888303_-1804811223","id":"20200904-093128_771082056","dateCreated":"2020-09-04T09:31:28+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:1565"},{"text":"%spark.pyspark\n\ndef fetch_income_data_for_calculation(sc, vintage):\n    query = {\n        \"query\": {\n            \"bool\": {\n                \"filter\": [\n                    {\n                        \"bool\": {\n                            \"must\": [\n                                {\n                                    \"match\": {\n                                        \"variableCode\": \"B25119\"\n                                    }\n                                },\n                                {\n                                    \"match\": {\n                                        \"variableCodeType\": \"003\"\n                                    }\n                                },\n                                {\n                                    \"match\": {\n                                        \"vintage\": vintage\n                                    }\n                                }\n                            ]\n                        }\n                    }\n                ]\n            }\n        }\n    }\n    es_read_conf = {\n        \"es.nodes\": \"https://vpc-elasticsearch-polarisapps-qc-kttkced2njswnhaa2n4mbou2cq.us-east-1.es.amazonaws.com\",\n        \"es.port\": \"443\",\n        \"es.resource\": \"pyxis-demographics/demographics\",\n        \"es.nodes.wan.only\": \"true\",\n        \"es.query\": json.dumps(query)\n    }\n    es_rdd = sc.newAPIHadoopRDD(\n        inputFormatClass=\"org.elasticsearch.hadoop.mr.EsInputFormat\",\n        keyClass=\"org.apache.hadoop.io.NullWritable\",\n        valueClass=\"org.elasticsearch.hadoop.mr.LinkedMapWritable\",\n        conf=es_read_conf)\n    return es_rdd\n\n","user":"anonymous","dateUpdated":"2020-09-08T13:37:25+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","editorHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1599502341399_-1244273749","id":"20200907-181221_2074095882","dateCreated":"2020-09-07T18:12:21+0000","dateStarted":"2020-09-07T18:34:55+0000","dateFinished":"2020-09-07T18:34:55+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1566"},{"text":"%spark.pyspark\n\nfrom pyspark.sql.types import Row\nfrom pyspark.sql.functions import col\nfrom pyspark.sql.functions import split\nfrom pyspark.sql.functions import format_string\n\ndef f(x):\n    d = x[1]\n    return d\n\ndata64 = spark.read.json('s3://qcpyxistest/demographics/B25064/_new_B25064-2011/acs5-2011-860-B25064.json')\n# print(data64.rdd.collect()[0])\n\ndata64 = data64.select( \\\nsplit(data64.geoId, 'US')[1].alias('geoId'), \\\ndata64.estimateValue, \\\nsplit(data64.variableCode, '_')[0].alias('variableCode'), \\\nsplit(data64.variableCode, '_')[1].alias('variableCodeType'), \\\ndata64.vintage, data64.estimateAnnotation, data64.marginAnnotation, data64.marginOfErrorValue)\n\n# data64 = data64.filter(data64.variableCode.endswith('_001')).select( \\\n# split(data64.geoId, 'US')[1].alias('geoId'), \\\n# data64.estimateValue, \\\n# split(data64.variableCode, '_')[0].alias('variableCode'), \\\n# split(data64.variableCode, '_')[1].alias('variableCodeType'), \\\n# data64.vintage, data64.estimateAnnotation, data64.marginAnnotation, data64.marginOfErrorValue)\n# print(data64.rdd.collect()[0])\n\n_data119 = fetch_income_data_for_calculation(sc,2018)\n# print(_data119.collect()[0])\n\ndata119 = _data119.map(lambda x: Row(**f(x))).toDF()\n# print(data119.rdd.collect()[0])\n\n\ndata64_119 = data64.alias('a').join(data119.alias('b'),col('b.geoId') == col('a.geoId')).select( \\\ncol('a.geoId'), \ncol('a.variableCode'),\ncol('a.variableCodeType'),\ncol('a.vintage'),\ncol('a.estimateValue'),\n((12*col('a.estimateValue'))/col('b.estimateValue')).alias('calculatedValue'),\n(format_string('%s-%s-%s_%s', 'a.geoId','a.vintage', 'a.variableCode','a.variableCodeType').alias('id')\n) \n)\n# data64_119.show()\ndata64_119.head()\n\n# finaldata=data64_119.rdd.map(lambda x: acs_data_formatter(x))\n# print(finaldata)\n\n\n\n","user":"anonymous","dateUpdated":"2020-09-08T13:57:19+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":93,"optionOpen":false}}},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Row(geoId='13160', variableCode='B25064', variableCodeType='001', vintage=2018, estimateValue=820, calculatedValue=0.2321521257018827, id='13160-2018-B25064_001')\n"}]},"apps":[],"jobName":"paragraph_1599503303836_410420043","id":"20200907-182823_473094850","dateCreated":"2020-09-07T18:28:23+0000","dateStarted":"2020-09-08T10:16:35+0000","dateFinished":"2020-09-08T10:16:37+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1567"},{"text":"%spark.pyspark\nfinaldata=data64_119.rdd.map(lambda x: acs_data_formatter(x))\nprint(finaldata.collect()[0])\n","user":"anonymous","dateUpdated":"2020-09-08T12:27:43+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"('12545-2018-B25064_001', '{\"id\": \"12545-2018-B25064_001\", \"geoId\": \"12545\", \"variableCodeType\": \"001\", \"variableCode\": \"B25064\", \"estimateValue\": 1123, \"calculatedValue\": 0.23509708483801747, \"vintage\": 2018}')\n"}]},"apps":[],"jobName":"paragraph_1599503530327_-1555351478","id":"20200907-183210_1766543274","dateCreated":"2020-09-07T18:32:10+0000","dateStarted":"2020-09-08T12:27:43+0000","dateFinished":"2020-09-08T12:27:45+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1568"},{"text":"%spark.pyspark\ndef acs_data_formatter(x):\n    print('x-->',x)\n    return (x['id'], json.dumps({\n        'id': x['id'],\n        'geoId':x['geoId'],\n        'variableCodeType':x['variableCodeType'],\n        'variableCode':x['variableCode'],\n        'estimateValue':x['estimateValue'],\n        'calculatedValue':x['calculatedValue'],\n        'vintage':x['vintage']\n    }))","user":"anonymous","dateUpdated":"2020-09-08T12:27:41+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1599536011937_-452877711","id":"20200908-033331_1889311756","dateCreated":"2020-09-08T03:33:31+0000","dateStarted":"2020-09-08T12:27:41+0000","dateFinished":"2020-09-08T12:27:41+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1569"},{"text":"%spark.pyspark\nimport json\nprint(acs_data_formatter({\n    'geoId':'00601',\n    'id':'id00601',\n    'estimateValue':363,\n    'calculatedValue':363,\n    'variableCode':'B25064',\n    'variableCodeType':'001',\n    'vintage':2018\n}))","user":"anonymous","dateUpdated":"2020-09-08T12:26:04+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","editorHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"x--> {'geoId': '00601', 'id': 'id00601', 'estimateValue': 363, 'calculatedValue': 363, 'variableCode': 'B25064', 'variableCodeType': '001', 'vintage': 2018}\n(<built-in function id>, '{\"id\": \"id00601\", \"geoId\": \"00601\", \"variableCodeType\": \"001\", \"variableCode\": \"B25064\", \"estimateValue\": 363, \"calculatedValue\": 363, \"vintage\": 2018}')\n"}]},"apps":[],"jobName":"paragraph_1599559076513_-852632701","id":"20200908-095756_742265739","dateCreated":"2020-09-08T09:57:56+0000","dateStarted":"2020-09-08T10:54:07+0000","dateFinished":"2020-09-08T10:54:07+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1570"},{"text":"%spark.pyspark\ndef main():\n    try:\n        es_write_conf_acs = {\n            \"es.nodes\": \"https://vpc-elasticsearch-polarisapps-qc-kttkced2njswnhaa2n4mbou2cq.us-east-1.es.amazonaws.com\",\n            \"es.port\": \"443\",\n            \"es.net.ssl\": \"true\",\n            \"es.nodes.wan.only\": \"true\",\n            \"es.resource\": \"pyxis-demographics/demographics\",\n            \"es.input.json\": \"true\",\n            \"es.mapping.id\": \"id\"\n        }\n\n        s3 = boto3.client('s3')\n        response = s3.list_objects_v2(\n            Bucket='qcpyxistest/demographics',\n            Prefix='',\n            MaxKeys=10000)\n        new_files=[]\n        if response['KeyCount'] > 0:\n            for content in response['Contents']:\n                if content[\"Key\"].find('_new_') != -1:\n                    new_files.append(content[\"Key\"])\n        logger.info(\"no of new files {}\".format(len(files)))\n\n        if len(new_files) > 0:\n            for file in new_files:\n                print(file)\n                df = spark.read.json(\"s3://qcpyxistest/{}\".format(file))\n\n                [demographicFileVariableCode,vintage]=file.split('/')[2].split('_')[2].split('-')\n                    \n                print(demographicFileVariableCode,vintage)\n                \n              \n\n                data = []\n                finalRdd = []\n\n                if(demographicFileVariableCode == \"B25064\"):\n                    incomedata_rdd = fetch_income_data_for_calculation(\n                        sc, vintage)\n\n                    data64 = df.select(\n                        split(df.geoId, 'US')[1].alias('geoId'),\n                        df.estimateValue,\n                        split(df.variableCode, '_')[\n                            0].alias('variableCode'),\n                        split(df.variableCode, '_')[\n                            1].alias('variableCodeType'),\n                        df.vintage, df.estimateAnnotation, df.marginAnnotation, df.marginOfErrorValue)\n                    _data119 = fetch_income_data_for_calculation(\n                        sc, vintage)\n\n                    data119 = _data119.map(lambda x: Row(**f(x))).toDF()\n\n                    data = data64.alias('a').join(data119.alias('b'), col('b.geoId') == col('a.geoId')).select(\n                        col('a.geoId'),\n                        col('a.variableCode'),\n                        col('a.variableCodeType'),\n                        col('a.vintage'),\n                        col('a.estimateValue'),\n                        ((12*col('a.estimateValue')) /\n                         col('b.estimateValue')).alias('calculatedValue'),\n                        (format_string('%s-%s-%s_%s', 'a.geoId', 'a.vintage', 'a.variableCode', 'a.variableCodeType').alias('id')\n                         )\n                    )\n                else:\n                    print(df.rdd.collect()[0])\n                    data = df.select(\n                        split(df.geoId, 'US')[1].alias('geoId'),\n                        df.estimateValue,\n                        split(df.variableCode, '_')[\n                            0].alias('variableCode'),\n                        split(df.variableCode, '_')[\n                            1].alias('variableCodeType'),\n                        df.vintage, df.estimateAnnotation, df.marginAnnotation, df.marginOfErrorValue)\n\n                    data = data.alias('a').select(\n                        col('a.geoId'),\n                        col('a.variableCode'),\n                        col('a.variableCodeType'),\n                        col('a.vintage'),\n                        col('a.estimateValue'),\n                        col('a.estimateValue').alias('calculatedValue'),\n                        (format_string('%s-%s-%s_%s', 'a.geoId', 'a.vintage', 'a.variableCode', 'a.variableCodeType').alias('id')\n                         )\n                    )\n\n                finalRdd = data.rdd.map(lambda x: acs_data_formatter(x))\n                finalRdd.saveAsNewAPIHadoopFile(\n                    path='-',\n                    outputFormatClass=\"org.elasticsearch.hadoop.mr.EsOutputFormat\",\n                    keyClass=\"org.apache.hadoop.io.NullWritable\",\n                    valueClass=\"org.elasticsearch.hadoop.mr.LinkedMapWritable\",\n                    conf=es_write_conf_acs)\n\n                s3Resource = boto3.resource('s3')\n                copy_source = {\n                    'Bucket': 'qcpyxistest',\n                    'Key': file}\n                s3Resource.meta.client.copy(\n                    copy_source, 'qcpyxistest', file.replace('_new_', ''))\n                logger.info(\n                    \"copy of {} is done \".format(file))\n                response = s3.delete_object(\n                    Bucket='qcpyxistest',\n                    Key=file)\n                logger.info(\n                    \"deleted  {} file \".format(file))\n                break\n\n        logger.info(\n            \"Job {} inserted all  records shutting down\".format(job_name))\n\n    except Exception as e:\n        logger.error(\"Error {}\".format(e))\n        raise e\n    finally:\n        # sh.stop_spark()\n        print(\"Done!!!\")","user":"anonymous","dateUpdated":"2020-09-09T09:25:50+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","lineNumbers":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1599559156506_957087171","id":"20200908-095916_1206608485","dateCreated":"2020-09-08T09:59:16+0000","dateStarted":"2020-09-09T09:25:50+0000","dateFinished":"2020-09-09T09:25:50+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1571"},{"text":"%spark.pyspark\nmain()","user":"anonymous","dateUpdated":"2020-09-09T09:12:47+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"2020-09-09 09:12:47,314 - acs_data - INFO - main - ln23 - no of new files 36\ndemographics/B25064/_new_B25064-2015/acs5-2015-860-B25064.json\nB25064 2015\n2020-09-09 09:13:03,980 - acs_data - INFO - main - ln104 - copy of demographics/B25064/_new_B25064-2015/acs5-2015-860-B25064.json is done \n2020-09-09 09:13:04,036 - acs_data - INFO - main - ln109 - deleted  demographics/B25064/_new_B25064-2015/acs5-2015-860-B25064.json file \n2020-09-09 09:13:04,036 - acs_data - INFO - main - ln113 - Job acs_data inserted all  records shutting down\nDone!!!\n"}]},"apps":[],"jobName":"paragraph_1599572359039_2049715456","id":"20200908-133919_1204320775","dateCreated":"2020-09-08T13:39:19+0000","dateStarted":"2020-09-09T09:12:47+0000","dateFinished":"2020-09-09T09:13:04+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1572"},{"text":"%spark.pyspark\n\n# variableCodeTypeArr = ['002']\n\nvariableCodeTypeArr = ['001', '002', '003', '004', '005', '006', '007', '008', '009', '010']\n\ndata64 = spark.read.json('s3://qcpyxistest/demographics/B25070/_new_B25070-2011/acs5-2011-860-B25070.json')\nprint(data64.rdd.collect()[0])\n\ndata64 = data64.select( \\\nsplit(data64.geoId, 'US')[1].alias('geoId'), \\\ndata64.estimateValue, \\\nsplit(data64.variableCode, '_')[0].alias('variableCode'), \\\nsplit(data64.variableCode, '_')[1].alias('variableCodeType'), \\\ndata64.vintage)\n\n# print(data64.rdd.count())\n\n# print(data64.rdd.collect()[0])\n\ndata64=data64.filter(data64.variableCodeType.isin(variableCodeTypeArr))\n\n# print(data64.rdd.count())\n\nprint(data64.show(1000))\n","user":"anonymous","dateUpdated":"2020-09-09T07:44:20+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Row(estimateAnnotation='', estimateValue='1592', geoId='8600000US00601', marginAnnotation='', marginOfErrorValue='222', variableCode='B25070_001', vintage='2011')\n+-----+-------------+------------+----------------+-------+\n|geoId|estimateValue|variableCode|variableCodeType|vintage|\n+-----+-------------+------------+----------------+-------+\n|00601|         1592|      B25070|             001|   2011|\n|00601|           18|      B25070|             002|   2011|\n|00601|           81|      B25070|             003|   2011|\n|00601|           59|      B25070|             004|   2011|\n|00601|          101|      B25070|             005|   2011|\n|00601|           51|      B25070|             006|   2011|\n|00601|           96|      B25070|             007|   2011|\n|00601|           77|      B25070|             008|   2011|\n|00601|           88|      B25070|             009|   2011|\n|00601|          244|      B25070|             010|   2011|\n|00602|         2711|      B25070|             001|   2011|\n|00602|          113|      B25070|             002|   2011|\n|00602|          144|      B25070|             003|   2011|\n|00602|           59|      B25070|             004|   2011|\n|00602|           47|      B25070|             005|   2011|\n|00602|          220|      B25070|             006|   2011|\n|00602|          107|      B25070|             007|   2011|\n|00602|           61|      B25070|             008|   2011|\n|00602|          107|      B25070|             009|   2011|\n|00602|          381|      B25070|             010|   2011|\n|00603|         5927|      B25070|             001|   2011|\n|00603|          143|      B25070|             002|   2011|\n|00603|          320|      B25070|             003|   2011|\n|00603|          389|      B25070|             004|   2011|\n|00603|          364|      B25070|             005|   2011|\n|00603|          271|      B25070|             006|   2011|\n|00603|          208|      B25070|             007|   2011|\n|00603|          263|      B25070|             008|   2011|\n|00603|          292|      B25070|             009|   2011|\n|00603|         1571|      B25070|             010|   2011|\n|00606|          521|      B25070|             001|   2011|\n|00606|            0|      B25070|             002|   2011|\n|00606|            0|      B25070|             003|   2011|\n|00606|           71|      B25070|             004|   2011|\n|00606|           47|      B25070|             005|   2011|\n|00606|           41|      B25070|             006|   2011|\n|00606|            9|      B25070|             007|   2011|\n|00606|            9|      B25070|             008|   2011|\n|00606|           43|      B25070|             009|   2011|\n|00606|           34|      B25070|             010|   2011|\n|00610|         1915|      B25070|             001|   2011|\n|00610|           15|      B25070|             002|   2011|\n|00610|           44|      B25070|             003|   2011|\n|00610|          118|      B25070|             004|   2011|\n|00610|           96|      B25070|             005|   2011|\n|00610|           84|      B25070|             006|   2011|\n|00610|           59|      B25070|             007|   2011|\n|00610|           30|      B25070|             008|   2011|\n|00610|           91|      B25070|             009|   2011|\n|00610|          214|      B25070|             010|   2011|\n|00612|         6310|      B25070|             001|   2011|\n|00612|           87|      B25070|             002|   2011|\n|00612|          289|      B25070|             003|   2011|\n|00612|          272|      B25070|             004|   2011|\n|00612|          293|      B25070|             005|   2011|\n|00612|          258|      B25070|             006|   2011|\n|00612|          248|      B25070|             007|   2011|\n|00612|          257|      B25070|             008|   2011|\n|00612|          441|      B25070|             009|   2011|\n|00612|         1246|      B25070|             010|   2011|\n|00616|          768|      B25070|             001|   2011|\n|00616|            0|      B25070|             002|   2011|\n|00616|           40|      B25070|             003|   2011|\n|00616|           32|      B25070|             004|   2011|\n|00616|           14|      B25070|             005|   2011|\n|00616|           42|      B25070|             006|   2011|\n|00616|           72|      B25070|             007|   2011|\n|00616|           14|      B25070|             008|   2011|\n|00616|            0|      B25070|             009|   2011|\n|00616|          152|      B25070|             010|   2011|\n|00617|         1836|      B25070|             001|   2011|\n|00617|            0|      B25070|             002|   2011|\n|00617|           27|      B25070|             003|   2011|\n|00617|           15|      B25070|             004|   2011|\n|00617|          251|      B25070|             005|   2011|\n|00617|           81|      B25070|             006|   2011|\n|00617|          121|      B25070|             007|   2011|\n|00617|           38|      B25070|             008|   2011|\n|00617|           43|      B25070|             009|   2011|\n|00617|          397|      B25070|             010|   2011|\n|00622|          567|      B25070|             001|   2011|\n|00622|           16|      B25070|             002|   2011|\n|00622|            0|      B25070|             003|   2011|\n|00622|            0|      B25070|             004|   2011|\n|00622|            0|      B25070|             005|   2011|\n|00622|            0|      B25070|             006|   2011|\n|00622|           11|      B25070|             007|   2011|\n|00622|           29|      B25070|             008|   2011|\n|00622|            0|      B25070|             009|   2011|\n|00622|           60|      B25070|             010|   2011|\n|00623|         3220|      B25070|             001|   2011|\n|00623|           43|      B25070|             002|   2011|\n|00623|           93|      B25070|             003|   2011|\n|00623|          141|      B25070|             004|   2011|\n|00623|          192|      B25070|             005|   2011|\n|00623|          125|      B25070|             006|   2011|\n|00623|          152|      B25070|             007|   2011|\n|00623|           74|      B25070|             008|   2011|\n|00623|          109|      B25070|             009|   2011|\n|00623|          465|      B25070|             010|   2011|\n|00624|         1789|      B25070|             001|   2011|\n|00624|            0|      B25070|             002|   2011|\n|00624|           54|      B25070|             003|   2011|\n|00624|          125|      B25070|             004|   2011|\n|00624|           68|      B25070|             005|   2011|\n|00624|           76|      B25070|             006|   2011|\n|00624|           39|      B25070|             007|   2011|\n|00624|           34|      B25070|             008|   2011|\n|00624|          100|      B25070|             009|   2011|\n|00624|          228|      B25070|             010|   2011|\n|00627|         2546|      B25070|             001|   2011|\n|00627|           23|      B25070|             002|   2011|\n|00627|            8|      B25070|             003|   2011|\n|00627|           58|      B25070|             004|   2011|\n|00627|          106|      B25070|             005|   2011|\n|00627|           87|      B25070|             006|   2011|\n|00627|          134|      B25070|             007|   2011|\n|00627|           77|      B25070|             008|   2011|\n|00627|          107|      B25070|             009|   2011|\n|00627|          347|      B25070|             010|   2011|\n|00631|          242|      B25070|             001|   2011|\n|00631|           11|      B25070|             002|   2011|\n|00631|            0|      B25070|             003|   2011|\n|00631|           11|      B25070|             004|   2011|\n|00631|            0|      B25070|             005|   2011|\n|00631|           13|      B25070|             006|   2011|\n|00631|           24|      B25070|             007|   2011|\n|00631|            9|      B25070|             008|   2011|\n|00631|            0|      B25070|             009|   2011|\n|00631|           22|      B25070|             010|   2011|\n|00637|         1942|      B25070|             001|   2011|\n|00637|           32|      B25070|             002|   2011|\n|00637|          103|      B25070|             003|   2011|\n|00637|           64|      B25070|             004|   2011|\n|00637|           65|      B25070|             005|   2011|\n|00637|           80|      B25070|             006|   2011|\n|00637|           89|      B25070|             007|   2011|\n|00637|           30|      B25070|             008|   2011|\n|00637|          163|      B25070|             009|   2011|\n|00637|          120|      B25070|             010|   2011|\n|00638|         1558|      B25070|             001|   2011|\n|00638|           11|      B25070|             002|   2011|\n|00638|           74|      B25070|             003|   2011|\n|00638|           99|      B25070|             004|   2011|\n|00638|           77|      B25070|             005|   2011|\n|00638|           85|      B25070|             006|   2011|\n|00638|           88|      B25070|             007|   2011|\n|00638|           83|      B25070|             008|   2011|\n|00638|           52|      B25070|             009|   2011|\n|00638|          143|      B25070|             010|   2011|\n|00641|         3363|      B25070|             001|   2011|\n|00641|           42|      B25070|             002|   2011|\n|00641|           95|      B25070|             003|   2011|\n|00641|           76|      B25070|             004|   2011|\n|00641|          146|      B25070|             005|   2011|\n|00641|          162|      B25070|             006|   2011|\n|00641|          114|      B25070|             007|   2011|\n|00641|          112|      B25070|             008|   2011|\n|00641|          125|      B25070|             009|   2011|\n|00641|          515|      B25070|             010|   2011|\n|00646|         1957|      B25070|             001|   2011|\n|00646|            6|      B25070|             002|   2011|\n|00646|           99|      B25070|             003|   2011|\n|00646|          178|      B25070|             004|   2011|\n|00646|           98|      B25070|             005|   2011|\n|00646|           75|      B25070|             006|   2011|\n|00646|           52|      B25070|             007|   2011|\n|00646|           76|      B25070|             008|   2011|\n|00646|           91|      B25070|             009|   2011|\n|00646|          317|      B25070|             010|   2011|\n|00647|          539|      B25070|             001|   2011|\n|00647|            0|      B25070|             002|   2011|\n|00647|            9|      B25070|             003|   2011|\n|00647|           11|      B25070|             004|   2011|\n|00647|           15|      B25070|             005|   2011|\n|00647|            0|      B25070|             006|   2011|\n|00647|           24|      B25070|             007|   2011|\n|00647|            0|      B25070|             008|   2011|\n|00647|            8|      B25070|             009|   2011|\n|00647|           51|      B25070|             010|   2011|\n|00650|         1079|      B25070|             001|   2011|\n|00650|           13|      B25070|             002|   2011|\n|00650|           82|      B25070|             003|   2011|\n|00650|           27|      B25070|             004|   2011|\n|00650|           58|      B25070|             005|   2011|\n|00650|            0|      B25070|             006|   2011|\n|00650|           34|      B25070|             007|   2011|\n|00650|           13|      B25070|             008|   2011|\n|00650|           50|      B25070|             009|   2011|\n|00650|          173|      B25070|             010|   2011|\n|00652|          230|      B25070|             001|   2011|\n|00652|            0|      B25070|             002|   2011|\n|00652|            0|      B25070|             003|   2011|\n|00652|            0|      B25070|             004|   2011|\n|00652|            0|      B25070|             005|   2011|\n|00652|            0|      B25070|             006|   2011|\n|00652|            0|      B25070|             007|   2011|\n|00652|           17|      B25070|             008|   2011|\n|00652|            0|      B25070|             009|   2011|\n|00652|           40|      B25070|             010|   2011|\n|00653|         1352|      B25070|             001|   2011|\n|00653|           28|      B25070|             002|   2011|\n|00653|           29|      B25070|             003|   2011|\n|00653|           23|      B25070|             004|   2011|\n|00653|           33|      B25070|             005|   2011|\n|00653|           74|      B25070|             006|   2011|\n|00653|           46|      B25070|             007|   2011|\n|00653|           57|      B25070|             008|   2011|\n|00653|           32|      B25070|             009|   2011|\n|00653|          155|      B25070|             010|   2011|\n|00656|         1380|      B25070|             001|   2011|\n|00656|            7|      B25070|             002|   2011|\n|00656|           50|      B25070|             003|   2011|\n|00656|           12|      B25070|             004|   2011|\n|00656|           56|      B25070|             005|   2011|\n|00656|           44|      B25070|             006|   2011|\n|00656|           74|      B25070|             007|   2011|\n|00656|           53|      B25070|             008|   2011|\n|00656|           66|      B25070|             009|   2011|\n|00656|          139|      B25070|             010|   2011|\n|00659|         3358|      B25070|             001|   2011|\n|00659|           95|      B25070|             002|   2011|\n|00659|          199|      B25070|             003|   2011|\n|00659|          148|      B25070|             004|   2011|\n|00659|          247|      B25070|             005|   2011|\n|00659|          124|      B25070|             006|   2011|\n|00659|          206|      B25070|             007|   2011|\n|00659|          135|      B25070|             008|   2011|\n|00659|          114|      B25070|             009|   2011|\n|00659|          355|      B25070|             010|   2011|\n|00660|         1763|      B25070|             001|   2011|\n|00660|           43|      B25070|             002|   2011|\n|00660|          145|      B25070|             003|   2011|\n|00660|          131|      B25070|             004|   2011|\n|00660|          182|      B25070|             005|   2011|\n|00660|          101|      B25070|             006|   2011|\n|00660|           49|      B25070|             007|   2011|\n|00660|           29|      B25070|             008|   2011|\n|00660|          102|      B25070|             009|   2011|\n|00660|          238|      B25070|             010|   2011|\n|00662|         5410|      B25070|             001|   2011|\n|00662|           14|      B25070|             002|   2011|\n|00662|          156|      B25070|             003|   2011|\n|00662|          107|      B25070|             004|   2011|\n|00662|          221|      B25070|             005|   2011|\n|00662|          124|      B25070|             006|   2011|\n|00662|          185|      B25070|             007|   2011|\n|00662|           51|      B25070|             008|   2011|\n|00662|          198|      B25070|             009|   2011|\n|00662|          611|      B25070|             010|   2011|\n|00664|         1619|      B25070|             001|   2011|\n|00664|           25|      B25070|             002|   2011|\n|00664|          156|      B25070|             003|   2011|\n|00664|           94|      B25070|             004|   2011|\n|00664|          139|      B25070|             005|   2011|\n|00664|           55|      B25070|             006|   2011|\n|00664|           16|      B25070|             007|   2011|\n|00664|           85|      B25070|             008|   2011|\n|00664|           66|      B25070|             009|   2011|\n|00664|          243|      B25070|             010|   2011|\n|00667|         2943|      B25070|             001|   2011|\n|00667|           14|      B25070|             002|   2011|\n|00667|           78|      B25070|             003|   2011|\n|00667|          110|      B25070|             004|   2011|\n|00667|           93|      B25070|             005|   2011|\n|00667|           77|      B25070|             006|   2011|\n|00667|           65|      B25070|             007|   2011|\n|00667|           73|      B25070|             008|   2011|\n|00667|           96|      B25070|             009|   2011|\n|00667|          307|      B25070|             010|   2011|\n|00669|         3331|      B25070|             001|   2011|\n|00669|           50|      B25070|             002|   2011|\n|00669|           89|      B25070|             003|   2011|\n|00669|          265|      B25070|             004|   2011|\n|00669|          104|      B25070|             005|   2011|\n|00669|          161|      B25070|             006|   2011|\n|00669|           35|      B25070|             007|   2011|\n|00669|           76|      B25070|             008|   2011|\n|00669|          168|      B25070|             009|   2011|\n|00669|          598|      B25070|             010|   2011|\n|00670|         1036|      B25070|             001|   2011|\n|00670|            7|      B25070|             002|   2011|\n|00670|           96|      B25070|             003|   2011|\n|00670|           39|      B25070|             004|   2011|\n|00670|           51|      B25070|             005|   2011|\n|00670|           22|      B25070|             006|   2011|\n|00670|           24|      B25070|             007|   2011|\n|00670|            0|      B25070|             008|   2011|\n|00670|           95|      B25070|             009|   2011|\n|00670|          201|      B25070|             010|   2011|\n|00674|         4441|      B25070|             001|   2011|\n|00674|           56|      B25070|             002|   2011|\n|00674|          178|      B25070|             003|   2011|\n|00674|          205|      B25070|             004|   2011|\n|00674|          296|      B25070|             005|   2011|\n|00674|          211|      B25070|             006|   2011|\n|00674|          222|      B25070|             007|   2011|\n|00674|           70|      B25070|             008|   2011|\n|00674|          228|      B25070|             009|   2011|\n|00674|          837|      B25070|             010|   2011|\n|00676|         2563|      B25070|             001|   2011|\n|00676|           12|      B25070|             002|   2011|\n|00676|           75|      B25070|             003|   2011|\n|00676|          125|      B25070|             004|   2011|\n|00676|           36|      B25070|             005|   2011|\n|00676|          163|      B25070|             006|   2011|\n|00676|           60|      B25070|             007|   2011|\n|00676|           41|      B25070|             008|   2011|\n|00676|          175|      B25070|             009|   2011|\n|00676|          459|      B25070|             010|   2011|\n|00677|         1095|      B25070|             001|   2011|\n|00677|            0|      B25070|             002|   2011|\n|00677|           48|      B25070|             003|   2011|\n|00677|           32|      B25070|             004|   2011|\n|00677|           89|      B25070|             005|   2011|\n|00677|           94|      B25070|             006|   2011|\n|00677|           30|      B25070|             007|   2011|\n|00677|           30|      B25070|             008|   2011|\n|00677|           45|      B25070|             009|   2011|\n|00677|          113|      B25070|             010|   2011|\n|00678|         3548|      B25070|             001|   2011|\n|00678|           42|      B25070|             002|   2011|\n|00678|           94|      B25070|             003|   2011|\n|00678|          117|      B25070|             004|   2011|\n|00678|          130|      B25070|             005|   2011|\n|00678|          153|      B25070|             006|   2011|\n|00678|           55|      B25070|             007|   2011|\n|00678|          135|      B25070|             008|   2011|\n|00678|          131|      B25070|             009|   2011|\n|00678|          396|      B25070|             010|   2011|\n|00680|         8684|      B25070|             001|   2011|\n|00680|          172|      B25070|             002|   2011|\n|00680|          314|      B25070|             003|   2011|\n|00680|          488|      B25070|             004|   2011|\n|00680|          572|      B25070|             005|   2011|\n|00680|          500|      B25070|             006|   2011|\n|00680|          459|      B25070|             007|   2011|\n|00680|          332|      B25070|             008|   2011|\n|00680|          439|      B25070|             009|   2011|\n|00680|         2091|      B25070|             010|   2011|\n|00682|         4669|      B25070|             001|   2011|\n|00682|          108|      B25070|             002|   2011|\n|00682|          220|      B25070|             003|   2011|\n|00682|          172|      B25070|             004|   2011|\n|00682|          263|      B25070|             005|   2011|\n|00682|          281|      B25070|             006|   2011|\n|00682|          128|      B25070|             007|   2011|\n|00682|          108|      B25070|             008|   2011|\n|00682|          323|      B25070|             009|   2011|\n|00682|         1363|      B25070|             010|   2011|\n|00683|         3077|      B25070|             001|   2011|\n|00683|           18|      B25070|             002|   2011|\n|00683|          156|      B25070|             003|   2011|\n|00683|          239|      B25070|             004|   2011|\n|00683|          196|      B25070|             005|   2011|\n|00683|          255|      B25070|             006|   2011|\n|00683|          151|      B25070|             007|   2011|\n|00683|          128|      B25070|             008|   2011|\n|00683|           99|      B25070|             009|   2011|\n|00683|          366|      B25070|             010|   2011|\n|00685|         3322|      B25070|             001|   2011|\n|00685|           55|      B25070|             002|   2011|\n|00685|           93|      B25070|             003|   2011|\n|00685|          245|      B25070|             004|   2011|\n|00685|          103|      B25070|             005|   2011|\n|00685|          187|      B25070|             006|   2011|\n|00685|          161|      B25070|             007|   2011|\n|00685|          120|      B25070|             008|   2011|\n|00685|          234|      B25070|             009|   2011|\n|00685|          711|      B25070|             010|   2011|\n|00687|         2072|      B25070|             001|   2011|\n|00687|           12|      B25070|             002|   2011|\n|00687|          105|      B25070|             003|   2011|\n|00687|          137|      B25070|             004|   2011|\n|00687|          104|      B25070|             005|   2011|\n|00687|          101|      B25070|             006|   2011|\n|00687|           44|      B25070|             007|   2011|\n|00687|           39|      B25070|             008|   2011|\n|00687|           95|      B25070|             009|   2011|\n|00687|          379|      B25070|             010|   2011|\n|00688|          580|      B25070|             001|   2011|\n|00688|           24|      B25070|             002|   2011|\n|00688|           12|      B25070|             003|   2011|\n|00688|            0|      B25070|             004|   2011|\n|00688|           48|      B25070|             005|   2011|\n|00688|            0|      B25070|             006|   2011|\n|00688|           13|      B25070|             007|   2011|\n|00688|           18|      B25070|             008|   2011|\n|00688|            0|      B25070|             009|   2011|\n|00688|           79|      B25070|             010|   2011|\n|00690|          568|      B25070|             001|   2011|\n|00690|           12|      B25070|             002|   2011|\n|00690|           20|      B25070|             003|   2011|\n|00690|           33|      B25070|             004|   2011|\n|00690|           14|      B25070|             005|   2011|\n|00690|           35|      B25070|             006|   2011|\n|00690|           38|      B25070|             007|   2011|\n|00690|           30|      B25070|             008|   2011|\n|00690|           35|      B25070|             009|   2011|\n|00690|          106|      B25070|             010|   2011|\n|00692|         2175|      B25070|             001|   2011|\n|00692|           11|      B25070|             002|   2011|\n|00692|          137|      B25070|             003|   2011|\n|00692|           78|      B25070|             004|   2011|\n|00692|           51|      B25070|             005|   2011|\n|00692|          127|      B25070|             006|   2011|\n|00692|           79|      B25070|             007|   2011|\n|00692|           52|      B25070|             008|   2011|\n|00692|          117|      B25070|             009|   2011|\n|00692|          307|      B25070|             010|   2011|\n|00693|         2850|      B25070|             001|   2011|\n|00693|           49|      B25070|             002|   2011|\n|00693|           86|      B25070|             003|   2011|\n|00693|          107|      B25070|             004|   2011|\n|00693|          127|      B25070|             005|   2011|\n|00693|           84|      B25070|             006|   2011|\n|00693|           81|      B25070|             007|   2011|\n|00693|          109|      B25070|             008|   2011|\n|00693|          141|      B25070|             009|   2011|\n|00693|          660|      B25070|             010|   2011|\n|00694|           13|      B25070|             001|   2011|\n|00694|            0|      B25070|             002|   2011|\n|00694|            0|      B25070|             003|   2011|\n|00694|            0|      B25070|             004|   2011|\n|00694|           13|      B25070|             005|   2011|\n|00694|            0|      B25070|             006|   2011|\n|00694|            0|      B25070|             007|   2011|\n|00694|            0|      B25070|             008|   2011|\n|00694|            0|      B25070|             009|   2011|\n|00694|            0|      B25070|             010|   2011|\n|00698|         3542|      B25070|             001|   2011|\n|00698|           57|      B25070|             002|   2011|\n|00698|          132|      B25070|             003|   2011|\n|00698|          126|      B25070|             004|   2011|\n|00698|          221|      B25070|             005|   2011|\n|00698|           78|      B25070|             006|   2011|\n|00698|           42|      B25070|             007|   2011|\n|00698|          128|      B25070|             008|   2011|\n|00698|          149|      B25070|             009|   2011|\n|00698|          413|      B25070|             010|   2011|\n|00703|         2785|      B25070|             001|   2011|\n|00703|           40|      B25070|             002|   2011|\n|00703|          129|      B25070|             003|   2011|\n|00703|           46|      B25070|             004|   2011|\n|00703|          154|      B25070|             005|   2011|\n|00703|           85|      B25070|             006|   2011|\n|00703|           79|      B25070|             007|   2011|\n|00703|           52|      B25070|             008|   2011|\n|00703|          112|      B25070|             009|   2011|\n|00703|          428|      B25070|             010|   2011|\n|00704|          903|      B25070|             001|   2011|\n|00704|           50|      B25070|             002|   2011|\n|00704|           24|      B25070|             003|   2011|\n|00704|            0|      B25070|             004|   2011|\n|00704|           58|      B25070|             005|   2011|\n|00704|            6|      B25070|             006|   2011|\n|00704|            0|      B25070|             007|   2011|\n|00704|           24|      B25070|             008|   2011|\n|00704|           43|      B25070|             009|   2011|\n|00704|          136|      B25070|             010|   2011|\n|00705|         1908|      B25070|             001|   2011|\n|00705|            9|      B25070|             002|   2011|\n|00705|           71|      B25070|             003|   2011|\n|00705|           36|      B25070|             004|   2011|\n|00705|          156|      B25070|             005|   2011|\n|00705|          202|      B25070|             006|   2011|\n|00705|          107|      B25070|             007|   2011|\n|00705|          160|      B25070|             008|   2011|\n|00705|          131|      B25070|             009|   2011|\n|00705|          434|      B25070|             010|   2011|\n|00707|          854|      B25070|             001|   2011|\n|00707|            8|      B25070|             002|   2011|\n|00707|           37|      B25070|             003|   2011|\n|00707|            0|      B25070|             004|   2011|\n|00707|           76|      B25070|             005|   2011|\n|00707|           30|      B25070|             006|   2011|\n|00707|           43|      B25070|             007|   2011|\n|00707|           11|      B25070|             008|   2011|\n|00707|           16|      B25070|             009|   2011|\n|00707|           63|      B25070|             010|   2011|\n|00714|         1597|      B25070|             001|   2011|\n|00714|            0|      B25070|             002|   2011|\n|00714|           51|      B25070|             003|   2011|\n|00714|           58|      B25070|             004|   2011|\n|00714|           74|      B25070|             005|   2011|\n|00714|           86|      B25070|             006|   2011|\n|00714|           58|      B25070|             007|   2011|\n|00714|           99|      B25070|             008|   2011|\n|00714|           54|      B25070|             009|   2011|\n|00714|          256|      B25070|             010|   2011|\n|00715|          281|      B25070|             001|   2011|\n|00715|            0|      B25070|             002|   2011|\n|00715|            0|      B25070|             003|   2011|\n|00715|           22|      B25070|             004|   2011|\n|00715|           34|      B25070|             005|   2011|\n|00715|           15|      B25070|             006|   2011|\n|00715|           27|      B25070|             007|   2011|\n|00715|            0|      B25070|             008|   2011|\n|00715|            0|      B25070|             009|   2011|\n|00715|           64|      B25070|             010|   2011|\n|00716|         4028|      B25070|             001|   2011|\n|00716|           37|      B25070|             002|   2011|\n|00716|          130|      B25070|             003|   2011|\n|00716|          300|      B25070|             004|   2011|\n|00716|          179|      B25070|             005|   2011|\n|00716|          237|      B25070|             006|   2011|\n|00716|          228|      B25070|             007|   2011|\n|00716|          155|      B25070|             008|   2011|\n|00716|          214|      B25070|             009|   2011|\n|00716|          790|      B25070|             010|   2011|\n|00717|         4078|      B25070|             001|   2011|\n|00717|          136|      B25070|             002|   2011|\n|00717|          204|      B25070|             003|   2011|\n|00717|          170|      B25070|             004|   2011|\n|00717|          261|      B25070|             005|   2011|\n|00717|          358|      B25070|             006|   2011|\n|00717|          223|      B25070|             007|   2011|\n|00717|          239|      B25070|             008|   2011|\n|00717|          218|      B25070|             009|   2011|\n|00717|          972|      B25070|             010|   2011|\n|00718|         1800|      B25070|             001|   2011|\n|00718|            0|      B25070|             002|   2011|\n|00718|           63|      B25070|             003|   2011|\n|00718|          100|      B25070|             004|   2011|\n|00718|          142|      B25070|             005|   2011|\n|00718|          104|      B25070|             006|   2011|\n|00718|           46|      B25070|             007|   2011|\n|00718|          107|      B25070|             008|   2011|\n|00718|          161|      B25070|             009|   2011|\n|00718|          375|      B25070|             010|   2011|\n|00719|         2092|      B25070|             001|   2011|\n|00719|           18|      B25070|             002|   2011|\n|00719|           63|      B25070|             003|   2011|\n|00719|           29|      B25070|             004|   2011|\n|00719|           93|      B25070|             005|   2011|\n|00719|          174|      B25070|             006|   2011|\n|00719|            0|      B25070|             007|   2011|\n|00719|           28|      B25070|             008|   2011|\n|00719|           54|      B25070|             009|   2011|\n|00719|          162|      B25070|             010|   2011|\n|00720|         1768|      B25070|             001|   2011|\n|00720|           18|      B25070|             002|   2011|\n|00720|           91|      B25070|             003|   2011|\n|00720|           76|      B25070|             004|   2011|\n|00720|          157|      B25070|             005|   2011|\n|00720|          134|      B25070|             006|   2011|\n|00720|           53|      B25070|             007|   2011|\n|00720|           33|      B25070|             008|   2011|\n|00720|           59|      B25070|             009|   2011|\n|00720|          218|      B25070|             010|   2011|\n|00723|         1313|      B25070|             001|   2011|\n|00723|           36|      B25070|             002|   2011|\n|00723|           70|      B25070|             003|   2011|\n|00723|           25|      B25070|             004|   2011|\n|00723|           61|      B25070|             005|   2011|\n|00723|           71|      B25070|             006|   2011|\n|00723|            0|      B25070|             007|   2011|\n|00723|           41|      B25070|             008|   2011|\n|00723|           28|      B25070|             009|   2011|\n|00723|          147|      B25070|             010|   2011|\n|00725|        10188|      B25070|             001|   2011|\n|00725|          105|      B25070|             002|   2011|\n|00725|          395|      B25070|             003|   2011|\n|00725|          616|      B25070|             004|   2011|\n|00725|          615|      B25070|             005|   2011|\n|00725|          628|      B25070|             006|   2011|\n|00725|          630|      B25070|             007|   2011|\n|00725|          561|      B25070|             008|   2011|\n|00725|          778|      B25070|             009|   2011|\n|00725|         1959|      B25070|             010|   2011|\n|00727|         3916|      B25070|             001|   2011|\n|00727|           53|      B25070|             002|   2011|\n|00727|          170|      B25070|             003|   2011|\n|00727|          177|      B25070|             004|   2011|\n|00727|          218|      B25070|             005|   2011|\n|00727|          304|      B25070|             006|   2011|\n|00727|          192|      B25070|             007|   2011|\n|00727|          153|      B25070|             008|   2011|\n|00727|          297|      B25070|             009|   2011|\n|00727|          848|      B25070|             010|   2011|\n|00728|         3307|      B25070|             001|   2011|\n|00728|           14|      B25070|             002|   2011|\n|00728|           60|      B25070|             003|   2011|\n|00728|          122|      B25070|             004|   2011|\n|00728|          207|      B25070|             005|   2011|\n|00728|          233|      B25070|             006|   2011|\n|00728|          140|      B25070|             007|   2011|\n|00728|          128|      B25070|             008|   2011|\n|00728|          160|      B25070|             009|   2011|\n|00728|          581|      B25070|             010|   2011|\n|00729|         3253|      B25070|             001|   2011|\n|00729|           62|      B25070|             002|   2011|\n|00729|          171|      B25070|             003|   2011|\n|00729|          206|      B25070|             004|   2011|\n|00729|          108|      B25070|             005|   2011|\n|00729|          150|      B25070|             006|   2011|\n|00729|           61|      B25070|             007|   2011|\n|00729|          198|      B25070|             008|   2011|\n|00729|          178|      B25070|             009|   2011|\n|00729|          345|      B25070|             010|   2011|\n|00730|         4601|      B25070|             001|   2011|\n|00730|           96|      B25070|             002|   2011|\n|00730|           80|      B25070|             003|   2011|\n|00730|          240|      B25070|             004|   2011|\n|00730|          269|      B25070|             005|   2011|\n|00730|          180|      B25070|             006|   2011|\n|00730|          188|      B25070|             007|   2011|\n|00730|          178|      B25070|             008|   2011|\n|00730|          369|      B25070|             009|   2011|\n|00730|          964|      B25070|             010|   2011|\n|00731|         1159|      B25070|             001|   2011|\n|00731|            7|      B25070|             002|   2011|\n|00731|           15|      B25070|             003|   2011|\n|00731|           70|      B25070|             004|   2011|\n|00731|           40|      B25070|             005|   2011|\n|00731|           16|      B25070|             006|   2011|\n|00731|            7|      B25070|             007|   2011|\n|00731|            8|      B25070|             008|   2011|\n|00731|           64|      B25070|             009|   2011|\n|00731|          205|      B25070|             010|   2011|\n|00735|         1020|      B25070|             001|   2011|\n|00735|            6|      B25070|             002|   2011|\n|00735|            0|      B25070|             003|   2011|\n|00735|           96|      B25070|             004|   2011|\n|00735|           54|      B25070|             005|   2011|\n|00735|          153|      B25070|             006|   2011|\n|00735|          101|      B25070|             007|   2011|\n|00735|           51|      B25070|             008|   2011|\n|00735|           82|      B25070|             009|   2011|\n|00735|          144|      B25070|             010|   2011|\n|00736|         5003|      B25070|             001|   2011|\n|00736|          113|      B25070|             002|   2011|\n|00736|          321|      B25070|             003|   2011|\n|00736|          330|      B25070|             004|   2011|\n|00736|          244|      B25070|             005|   2011|\n|00736|          458|      B25070|             006|   2011|\n|00736|          363|      B25070|             007|   2011|\n|00736|          170|      B25070|             008|   2011|\n|00736|          173|      B25070|             009|   2011|\n|00736|          679|      B25070|             010|   2011|\n|00738|         3163|      B25070|             001|   2011|\n|00738|           70|      B25070|             002|   2011|\n|00738|          137|      B25070|             003|   2011|\n|00738|          223|      B25070|             004|   2011|\n|00738|          154|      B25070|             005|   2011|\n|00738|          122|      B25070|             006|   2011|\n|00738|          160|      B25070|             007|   2011|\n|00738|          149|      B25070|             008|   2011|\n|00738|          282|      B25070|             009|   2011|\n|00738|          570|      B25070|             010|   2011|\n|00739|         2831|      B25070|             001|   2011|\n|00739|           57|      B25070|             002|   2011|\n|00739|          145|      B25070|             003|   2011|\n|00739|          299|      B25070|             004|   2011|\n|00739|          225|      B25070|             005|   2011|\n|00739|          171|      B25070|             006|   2011|\n|00739|           91|      B25070|             007|   2011|\n|00739|           67|      B25070|             008|   2011|\n|00739|          133|      B25070|             009|   2011|\n|00739|          428|      B25070|             010|   2011|\n|00740|          348|      B25070|             001|   2011|\n|00740|            0|      B25070|             002|   2011|\n|00740|           10|      B25070|             003|   2011|\n|00740|            0|      B25070|             004|   2011|\n|00740|           10|      B25070|             005|   2011|\n|00740|           38|      B25070|             006|   2011|\n|00740|           17|      B25070|             007|   2011|\n|00740|            0|      B25070|             008|   2011|\n|00740|           69|      B25070|             009|   2011|\n|00740|           74|      B25070|             010|   2011|\n|00741|          258|      B25070|             001|   2011|\n|00741|            0|      B25070|             002|   2011|\n|00741|            6|      B25070|             003|   2011|\n|00741|           11|      B25070|             004|   2011|\n|00741|           23|      B25070|             005|   2011|\n|00741|            0|      B25070|             006|   2011|\n|00741|           22|      B25070|             007|   2011|\n|00741|            0|      B25070|             008|   2011|\n|00741|            0|      B25070|             009|   2011|\n|00741|           45|      B25070|             010|   2011|\n|00745|         3530|      B25070|             001|   2011|\n|00745|           47|      B25070|             002|   2011|\n|00745|          188|      B25070|             003|   2011|\n|00745|          154|      B25070|             004|   2011|\n|00745|          192|      B25070|             005|   2011|\n|00745|          205|      B25070|             006|   2011|\n|00745|          193|      B25070|             007|   2011|\n|00745|          158|      B25070|             008|   2011|\n|00745|           99|      B25070|             009|   2011|\n|00745|          552|      B25070|             010|   2011|\n|00751|         2116|      B25070|             001|   2011|\n|00751|           63|      B25070|             002|   2011|\n|00751|           67|      B25070|             003|   2011|\n|00751|          121|      B25070|             004|   2011|\n|00751|           51|      B25070|             005|   2011|\n|00751|          161|      B25070|             006|   2011|\n|00751|           64|      B25070|             007|   2011|\n|00751|           56|      B25070|             008|   2011|\n|00751|           51|      B25070|             009|   2011|\n|00751|          300|      B25070|             010|   2011|\n|00754|         3678|      B25070|             001|   2011|\n|00754|           57|      B25070|             002|   2011|\n|00754|           98|      B25070|             003|   2011|\n|00754|          152|      B25070|             004|   2011|\n|00754|          173|      B25070|             005|   2011|\n|00754|          118|      B25070|             006|   2011|\n|00754|          165|      B25070|             007|   2011|\n|00754|           88|      B25070|             008|   2011|\n|00754|          135|      B25070|             009|   2011|\n|00754|          662|      B25070|             010|   2011|\n|00757|         1956|      B25070|             001|   2011|\n|00757|           25|      B25070|             002|   2011|\n|00757|          113|      B25070|             003|   2011|\n|00757|          163|      B25070|             004|   2011|\n|00757|          115|      B25070|             005|   2011|\n|00757|          158|      B25070|             006|   2011|\n|00757|           29|      B25070|             007|   2011|\n|00757|           43|      B25070|             008|   2011|\n|00757|           89|      B25070|             009|   2011|\n|00757|          317|      B25070|             010|   2011|\n|00765|          599|      B25070|             001|   2011|\n|00765|            0|      B25070|             002|   2011|\n|00765|           46|      B25070|             003|   2011|\n|00765|           38|      B25070|             004|   2011|\n|00765|           22|      B25070|             005|   2011|\n|00765|           62|      B25070|             006|   2011|\n|00765|           16|      B25070|             007|   2011|\n|00765|           26|      B25070|             008|   2011|\n|00765|           20|      B25070|             009|   2011|\n|00765|          133|      B25070|             010|   2011|\n|00766|         1854|      B25070|             001|   2011|\n|00766|           45|      B25070|             002|   2011|\n|00766|           89|      B25070|             003|   2011|\n|00766|           63|      B25070|             004|   2011|\n|00766|          146|      B25070|             005|   2011|\n|00766|          161|      B25070|             006|   2011|\n|00766|           68|      B25070|             007|   2011|\n|00766|           93|      B25070|             008|   2011|\n|00766|           77|      B25070|             009|   2011|\n|00766|          172|      B25070|             010|   2011|\n|00767|         2844|      B25070|             001|   2011|\n|00767|            0|      B25070|             002|   2011|\n|00767|          109|      B25070|             003|   2011|\n|00767|          139|      B25070|             004|   2011|\n|00767|           35|      B25070|             005|   2011|\n|00767|           90|      B25070|             006|   2011|\n|00767|          113|      B25070|             007|   2011|\n|00767|          103|      B25070|             008|   2011|\n|00767|          103|      B25070|             009|   2011|\n|00767|          557|      B25070|             010|   2011|\n|00769|         2629|      B25070|             001|   2011|\n|00769|           56|      B25070|             002|   2011|\n|00769|           71|      B25070|             003|   2011|\n|00769|          169|      B25070|             004|   2011|\n|00769|          182|      B25070|             005|   2011|\n|00769|          159|      B25070|             006|   2011|\n|00769|           70|      B25070|             007|   2011|\n|00769|           32|      B25070|             008|   2011|\n|00769|          122|      B25070|             009|   2011|\n|00769|          740|      B25070|             010|   2011|\n|00771|         2731|      B25070|             001|   2011|\n|00771|          103|      B25070|             002|   2011|\n|00771|          141|      B25070|             003|   2011|\n|00771|          212|      B25070|             004|   2011|\n|00771|          143|      B25070|             005|   2011|\n|00771|           52|      B25070|             006|   2011|\n|00771|          143|      B25070|             007|   2011|\n|00771|           92|      B25070|             008|   2011|\n|00771|           63|      B25070|             009|   2011|\n|00771|          643|      B25070|             010|   2011|\n|00772|         1698|      B25070|             001|   2011|\n|00772|           37|      B25070|             002|   2011|\n|00772|           28|      B25070|             003|   2011|\n|00772|          122|      B25070|             004|   2011|\n|00772|           19|      B25070|             005|   2011|\n|00772|          107|      B25070|             006|   2011|\n|00772|           27|      B25070|             007|   2011|\n|00772|            0|      B25070|             008|   2011|\n|00772|           61|      B25070|             009|   2011|\n|00772|          207|      B25070|             010|   2011|\n|00773|         1679|      B25070|             001|   2011|\n|00773|           36|      B25070|             002|   2011|\n|00773|           78|      B25070|             003|   2011|\n|00773|           85|      B25070|             004|   2011|\n|00773|           73|      B25070|             005|   2011|\n|00773|          122|      B25070|             006|   2011|\n|00773|           83|      B25070|             007|   2011|\n|00773|           43|      B25070|             008|   2011|\n|00773|          102|      B25070|             009|   2011|\n|00773|          326|      B25070|             010|   2011|\n|00775|          128|      B25070|             001|   2011|\n|00775|            4|      B25070|             002|   2011|\n|00775|            4|      B25070|             003|   2011|\n|00775|            5|      B25070|             004|   2011|\n|00775|            0|      B25070|             005|   2011|\n|00775|           14|      B25070|             006|   2011|\n|00775|            0|      B25070|             007|   2011|\n|00775|            6|      B25070|             008|   2011|\n|00775|           10|      B25070|             009|   2011|\n|00775|           14|      B25070|             010|   2011|\n|00777|         3062|      B25070|             001|   2011|\n|00777|           19|      B25070|             002|   2011|\n|00777|          143|      B25070|             003|   2011|\n|00777|          107|      B25070|             004|   2011|\n|00777|          174|      B25070|             005|   2011|\n|00777|          133|      B25070|             006|   2011|\n|00777|          129|      B25070|             007|   2011|\n|00777|           72|      B25070|             008|   2011|\n|00777|          262|      B25070|             009|   2011|\n|00777|          318|      B25070|             010|   2011|\n|00778|         2210|      B25070|             001|   2011|\n|00778|           49|      B25070|             002|   2011|\n|00778|           35|      B25070|             003|   2011|\n|00778|          149|      B25070|             004|   2011|\n|00778|           47|      B25070|             005|   2011|\n|00778|          252|      B25070|             006|   2011|\n|00778|          112|      B25070|             007|   2011|\n|00778|           49|      B25070|             008|   2011|\n|00778|          145|      B25070|             009|   2011|\n|00778|          519|      B25070|             010|   2011|\n|00780|          824|      B25070|             001|   2011|\n|00780|            7|      B25070|             002|   2011|\n|00780|           32|      B25070|             003|   2011|\n|00780|           57|      B25070|             004|   2011|\n|00780|           92|      B25070|             005|   2011|\n|00780|           43|      B25070|             006|   2011|\n|00780|           48|      B25070|             007|   2011|\n|00780|           20|      B25070|             008|   2011|\n|00780|           44|      B25070|             009|   2011|\n|00780|           73|      B25070|             010|   2011|\n|00782|         1964|      B25070|             001|   2011|\n|00782|           91|      B25070|             002|   2011|\n|00782|          105|      B25070|             003|   2011|\n|00782|           72|      B25070|             004|   2011|\n|00782|          118|      B25070|             005|   2011|\n|00782|           54|      B25070|             006|   2011|\n|00782|           19|      B25070|             007|   2011|\n|00782|           69|      B25070|             008|   2011|\n|00782|           28|      B25070|             009|   2011|\n|00782|          141|      B25070|             010|   2011|\n|00783|         2931|      B25070|             001|   2011|\n|00783|            0|      B25070|             002|   2011|\n|00783|          165|      B25070|             003|   2011|\n|00783|           67|      B25070|             004|   2011|\n|00783|           63|      B25070|             005|   2011|\n|00783|          144|      B25070|             006|   2011|\n|00783|           83|      B25070|             007|   2011|\n|00783|          120|      B25070|             008|   2011|\n|00783|           49|      B25070|             009|   2011|\n|00783|          384|      B25070|             010|   2011|\n|00784|         4086|      B25070|             001|   2011|\n|00784|           51|      B25070|             002|   2011|\n|00784|          140|      B25070|             003|   2011|\n|00784|          223|      B25070|             004|   2011|\n|00784|          291|      B25070|             005|   2011|\n|00784|          291|      B25070|             006|   2011|\n|00784|          150|      B25070|             007|   2011|\n|00784|           84|      B25070|             008|   2011|\n|00784|          290|      B25070|             009|   2011|\n|00784|          578|      B25070|             010|   2011|\n|00786|           10|      B25070|             001|   2011|\n|00786|            0|      B25070|             002|   2011|\n|00786|           10|      B25070|             003|   2011|\n|00786|            0|      B25070|             004|   2011|\n|00786|            0|      B25070|             005|   2011|\n|00786|            0|      B25070|             006|   2011|\n|00786|            0|      B25070|             007|   2011|\n|00786|            0|      B25070|             008|   2011|\n|00786|            0|      B25070|             009|   2011|\n|00786|            0|      B25070|             010|   2011|\n|00791|         3843|      B25070|             001|   2011|\n|00791|           61|      B25070|             002|   2011|\n|00791|          183|      B25070|             003|   2011|\n|00791|          288|      B25070|             004|   2011|\n|00791|          301|      B25070|             005|   2011|\n|00791|          253|      B25070|             006|   2011|\n|00791|          419|      B25070|             007|   2011|\n|00791|          131|      B25070|             008|   2011|\n|00791|          176|      B25070|             009|   2011|\n|00791|          581|      B25070|             010|   2011|\n|00794|         2486|      B25070|             001|   2011|\n|00794|           87|      B25070|             002|   2011|\n|00794|          111|      B25070|             003|   2011|\n|00794|           94|      B25070|             004|   2011|\n|00794|          172|      B25070|             005|   2011|\n|00794|          119|      B25070|             006|   2011|\n|00794|           70|      B25070|             007|   2011|\n|00794|           55|      B25070|             008|   2011|\n|00794|          125|      B25070|             009|   2011|\n|00794|          378|      B25070|             010|   2011|\n|00795|         3408|      B25070|             001|   2011|\n|00795|           81|      B25070|             002|   2011|\n|00795|          107|      B25070|             003|   2011|\n|00795|          320|      B25070|             004|   2011|\n|00795|          187|      B25070|             005|   2011|\n|00795|          197|      B25070|             006|   2011|\n|00795|          171|      B25070|             007|   2011|\n|00795|           91|      B25070|             008|   2011|\n|00795|          145|      B25070|             009|   2011|\n|00795|          491|      B25070|             010|   2011|\n|00901|         1706|      B25070|             001|   2011|\n|00901|          134|      B25070|             002|   2011|\n|00901|           72|      B25070|             003|   2011|\n|00901|          149|      B25070|             004|   2011|\n|00901|           95|      B25070|             005|   2011|\n|00901|          107|      B25070|             006|   2011|\n|00901|          147|      B25070|             007|   2011|\n|00901|           50|      B25070|             008|   2011|\n|00901|          142|      B25070|             009|   2011|\n|00901|          307|      B25070|             010|   2011|\n|00906|            0|      B25070|             001|   2011|\n|00906|            0|      B25070|             002|   2011|\n|00906|            0|      B25070|             003|   2011|\n|00906|            0|      B25070|             004|   2011|\n|00906|            0|      B25070|             005|   2011|\n|00906|            0|      B25070|             006|   2011|\n|00906|            0|      B25070|             007|   2011|\n|00906|            0|      B25070|             008|   2011|\n|00906|            0|      B25070|             009|   2011|\n|00906|            0|      B25070|             010|   2011|\n|00907|         3293|      B25070|             001|   2011|\n|00907|          138|      B25070|             002|   2011|\n|00907|          161|      B25070|             003|   2011|\n|00907|          275|      B25070|             004|   2011|\n|00907|          228|      B25070|             005|   2011|\n|00907|          327|      B25070|             006|   2011|\n|00907|          246|      B25070|             007|   2011|\n|00907|          208|      B25070|             008|   2011|\n|00907|          297|      B25070|             009|   2011|\n|00907|          762|      B25070|             010|   2011|\n|00909|         1563|      B25070|             001|   2011|\n|00909|           41|      B25070|             002|   2011|\n|00909|           46|      B25070|             003|   2011|\n|00909|          153|      B25070|             004|   2011|\n|00909|           82|      B25070|             005|   2011|\n|00909|          181|      B25070|             006|   2011|\n|00909|          150|      B25070|             007|   2011|\n|00909|           37|      B25070|             008|   2011|\n|00909|           87|      B25070|             009|   2011|\n|00909|          460|      B25070|             010|   2011|\n|00911|         1682|      B25070|             001|   2011|\n|00911|           82|      B25070|             002|   2011|\n|00911|          135|      B25070|             003|   2011|\n|00911|          133|      B25070|             004|   2011|\n|00911|          239|      B25070|             005|   2011|\n|00911|          204|      B25070|             006|   2011|\n|00911|          164|      B25070|             007|   2011|\n|00911|           75|      B25070|             008|   2011|\n|00911|           82|      B25070|             009|   2011|\n|00911|          347|      B25070|             010|   2011|\n|00912|         1364|      B25070|             001|   2011|\n|00912|           24|      B25070|             002|   2011|\n|00912|            0|      B25070|             003|   2011|\n|00912|           69|      B25070|             004|   2011|\n|00912|          173|      B25070|             005|   2011|\n|00912|          109|      B25070|             006|   2011|\n|00912|          100|      B25070|             007|   2011|\n|00912|           61|      B25070|             008|   2011|\n|00912|           77|      B25070|             009|   2011|\n|00912|          409|      B25070|             010|   2011|\n|00913|         2922|      B25070|             001|   2011|\n|00913|          129|      B25070|             002|   2011|\n|00913|          173|      B25070|             003|   2011|\n|00913|          118|      B25070|             004|   2011|\n|00913|          211|      B25070|             005|   2011|\n|00913|          104|      B25070|             006|   2011|\n|00913|          230|      B25070|             007|   2011|\n|00913|          145|      B25070|             008|   2011|\n|00913|           74|      B25070|             009|   2011|\n|00913|          711|      B25070|             010|   2011|\n|00915|         6748|      B25070|             001|   2011|\n|00915|          181|      B25070|             002|   2011|\n|00915|          277|      B25070|             003|   2011|\n|00915|          269|      B25070|             004|   2011|\n|00915|          669|      B25070|             005|   2011|\n|00915|          497|      B25070|             006|   2011|\n|00915|          470|      B25070|             007|   2011|\n|00915|          402|      B25070|             008|   2011|\n|00915|          376|      B25070|             009|   2011|\n|00915|         1367|      B25070|             010|   2011|\n|00917|         3859|      B25070|             001|   2011|\n|00917|          126|      B25070|             002|   2011|\n|00917|          178|      B25070|             003|   2011|\n|00917|          203|      B25070|             004|   2011|\n|00917|          432|      B25070|             005|   2011|\n|00917|          287|      B25070|             006|   2011|\n|00917|          245|      B25070|             007|   2011|\n|00917|          230|      B25070|             008|   2011|\n|00917|          223|      B25070|             009|   2011|\n|00917|          918|      B25070|             010|   2011|\n|00918|         3499|      B25070|             001|   2011|\n|00918|          188|      B25070|             002|   2011|\n|00918|          262|      B25070|             003|   2011|\n|00918|          317|      B25070|             004|   2011|\n|00918|          439|      B25070|             005|   2011|\n|00918|          327|      B25070|             006|   2011|\n|00918|          220|      B25070|             007|   2011|\n|00918|          106|      B25070|             008|   2011|\n|00918|          163|      B25070|             009|   2011|\n|00918|          615|      B25070|             010|   2011|\n+-----+-------------+------------+----------------+-------+\nonly showing top 1000 rows\n\nNone\n"}]},"apps":[],"jobName":"paragraph_1599572382095_-1601271510","id":"20200908-133942_1100274939","dateCreated":"2020-09-08T13:39:42+0000","dateStarted":"2020-09-09T07:44:08+0000","dateFinished":"2020-09-09T07:44:16+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1573"},{"text":"%spark.pyspark\nstr='demographics/B25092/_new_B25092-2011/acs5-2011-860-B25092.json'\n[demographicFileVariableCode,vintage]=str.split('/')[2].split('_')[2].split('-')\nprint(demographicFileVariableCode,vintage)\n# data64 = data64.filter(data64.variableCode.endswith('_001')).select( \\\n# split(data64.geoId, 'US')[1].alias('geoId'), \\\n# data64.estimateValue, \\\n# split(data64.variableCode, '_')[0].alias('variableCode'), \\\n# split(data64.variableCode, '_')[1].alias('variableCodeType'), \\\n# data64.vintage, data64.estimateAnnotation, data64.marginAnnotation, data64.marginOfErrorValue)\n# print(data64.rdd.collect()[0])\n","user":"anonymous","dateUpdated":"2020-09-08T14:56:30+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"B25064 2011\n"}]},"apps":[],"jobName":"paragraph_1599573464082_1352529734","id":"20200908-135744_214035116","dateCreated":"2020-09-08T13:57:44+0000","dateStarted":"2020-09-08T14:05:02+0000","dateFinished":"2020-09-08T14:05:02+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1574"},{"text":"%spark.pyspark\n","user":"anonymous","dateUpdated":"2020-09-08T14:02:45+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1599573765035_-330555190","id":"20200908-140245_1885806633","dateCreated":"2020-09-08T14:02:45+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:1575"}],"name":"ACS_Test","id":"2FKMRCXJT","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}